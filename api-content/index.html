{"posts":[{"title":"🥭mongodb学习","content":"docker中挂载mongodbdockerrun-p27017:27017-v/data/mongo:/data/db--namemongodb-dmongo特别注意：挂载的/data/db目录必须要有，并确保该目录有写权mkdir-p/data/p💨QuickStart数据库操作#查看当前指向数据库db#CRUD##插入(MAX_SIZE=48MBp)db.good.insert(&lt;文档&gt;)###若想插入多条数据？（插入集合）post1={&quot;title&quot;:&quot;blog1&quot;,&quot;date&quot;:newDate()}post2={&quot;title&quot;:&quot;blog2&quot;,&quot;date&quot;:newDate()}post3={&quot;title&quot;:&quot;blog3&quot;,&quot;date&quot;:newDate()}db.good.insert([post1,post2,post3])##查询###查一个db.good.findOne()###find会显示至多20条数据##更新###增加字段（增加评论字段）post.comments=[]###更新数据db.good.update({title:&quot;myblogupdate&quot;},post)##删除db.good.remove({title:&quot;myblogupdate&quot;})Java开发中使用/**对于mongodb-java-driver3.7以下的版本适用*//**********************无验证版本**********************///new一个mongoClientMongoClientmongoClient=newMongoClient(&quot;&lt;host&gt;&quot;,&lt;port&gt;);//获取mongo数据库MongoDatabasemongoDatabase=mongoClient.getDatabase(&quot;&lt;database_name&gt;&quot;);/**********************有验证版本**********************/ServerAddressserverAddress=newServerAddress(&quot;&lt;host&gt;&quot;,27017);List&lt;ServerAddress&gt;addressList=newArrayList&lt;&gt;();addressList.add(serverAddress);//mongo验证MongoCredentialcredential=MongoCredential.createScramSha1Credential(&quot;username&quot;,&quot;databaseName&quot;,&quot;password&quot;.toCharArray());List&lt;MongoCredential&gt;credentials=newArrayList&lt;&gt;();credentials.add(credential);MongoClientmongoClient=newMongoClient(addressList,credentials);MongoDatabasemongoDatabase=mongoClient.getDatabase(&quot;databaseName&quot;);System.out.println(&quot;Connectsuccessfully&quot;);/**对于mongodb-java-driver3.7以上的版本适用*仅仅是这两处的不同*///连接到mongodb服务mongoClient=MongoClients.create(MongoClientSettings.builder().applyToClusterSettings(builder-&gt;builder.hosts(Arrays.asList(newServerAddress(&quot;192.168.216.131&quot;)))).build());//连接到数据库mongoDatabase=mongoClient.getDatabase(&quot;testdb&quot;);Tips:对于mongo3.7以上的版本，java中对mongo的API完全不同若是对3.7以上的版本采用新API，那么就会报nullpoint错误主要是要区分com.mongodb.MongoClient(类)和com.mongodb.client.MongoClient是接口。报becausetherewasasocketexceptionraisedbythisconnection.错误是因为数据量太大，读不出来还有可能就是未授权yml配置需要采用authentication-database:admin进行授权参考资料：mongoDBJVMDrivers（4.2）文档mongo-java-API文档关于socketexceptionrised错误采用authentication-database:admin进行授权问题(视频)mongo索引查询/***@titlegetTxByAddress*@description通过地址找交易*@authorDiomChen*@updateTime2021/7/1217:55*@throws*@测试数据：*17yYyafrfiaaVJGcaeQdpAeHdcBQSKAuLD*/@TestpublicvoidgetTxByAddress(){Queryquery=newQuery(Criteria.where(&quot;address&quot;).is(&quot;17yYyafrfiaaVJGcaeQdpAeHdcBQSKAuLD&quot;));List&lt;Addresstxs&gt;addresstxsList=mongoTemplate.find(query,Addresstxs.class);Stringtxid=addresstxsList.get(0).getTxid();Queryquery1=newQuery(Criteria.where(&quot;txid&quot;).is(txid));System.out.println(mongoTemplate.find(query1,Transactions.class));}无索引以address建立索引参考链接：SpringBoot2使用mongoTemplate创建集合并添加索引MongoDB索引管理－索引的创建、查看、删除在MongoDB中执行查询与创建索引基本内容文档：对应关系型数据库中的行，但是内部有顺序集合：对应关系型数据库中的表，是有多个文档组成，对于文档内部不关心（动态模式）数据类型null：{&quot;x&quot;:null}布尔：{&quot;x&quot;:false}数值：{&quot;x&quot;:3}字符串：{&quot;x&quot;:&quot;str&quot;}日期：{&quot;x&quot;:newDate()}正则表达式：{&quot;x&quot;:/foobar/i}数组：{&quot;x&quot;:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]}内嵌文档：{&quot;x&quot;:{&quot;foo&quot;,&quot;bar&quot;}}对象id：{&quot;x&quot;:ObjectId()}二进制数据：{&quot;x&quot;:}代码：{&quot;x&quot;:function(){/**/}}","link":"https://Diomchen.github.io/post/mongodb-xue-xi/"},{"title":"🧶neo4j文档整理","content":"1.🛠环境部署方面1.1版本选择对于neo4j版本方面，3.x对应Java8，4.x对应Java11。现在87和88机器上使用的都是4.x版本。1.2部署🐋docker中部署拉取neo4j镜像，指定7474，7687端口的映射。但是一定要指定import和data映射文件夹🖥服务器直接部署下载解压ce版本更改/conf/neo4j.conf文件，之后启动./bin/neoj#WithdefaultconfigurationNeo4jonlyacceptslocalconnections.#Toacceptnon-localconnections,uncommentthisline:#特别注意：默认是注释的，不开启，外网不能访问web端口neo4jdbms.default_listen_address=0.0.0.0#Youcanalsochooseaspecificnetworkinterface,andconfigureanon-default#portforeachconnector,bysettingtheirindividuallisten_address.#Theaddressatwhichthisservercanbereachedbyitsclients.Thismaybetheserver'sIPaddressorDNSname,or#itmaybetheaddressofareverseproxywhichsitsinfrontoftheserver.Thissettingmaybeoverriddenfor#individualconnectorsbelow.#dbms.default_advertised_address=localhost#YoucanalsochooseaspecificadvertisedhostnameorIPaddress,and#configureanadvertisedportforeachconnector,bysettingtheir#individualadvertised_address.#Bydefault,encryptionisturnedoff.#Toturnonencryption,ansslpolicyfortheconnectorneedstobeconfigured#ReadmoreinSSLpolicysectioninthisfileforhowtodefineaSSLpolicy.#Boltconnectordbms.connector.bolt.enabled=true#dbms.connector.bolt.tls_level=DISABLEDdbms.connector.bolt.listen_address=0.0.0.0:7687#dbms.connector.bolt.advertised_address=:7687#HTTPConnector.TherecanbezerooroneHTTPconnectors.dbms.connector.http.enabled=truedbms.connector.http.listen_address=0.0.0.0:7474#dbms.connector.http.advertised_address=:7474#HTTPSConnector.TherecanbezerooroneHTTPSconnectors.dbms.connector.https.enabled=falsedbms.connector.https.listen_address=0.0.0.0:7473#dbms.connector.https.advertised_address=:74732.☕java开发方面2.1设置驱动启动不推荐，推荐springboot的自动配置//设置driverDriverdriver=GraphDatabase.driver(&quot;bolt://192.168.216.131:7687&quot;,AuthTokens.basic(&quot;neo4j&quot;,&quot;123456&quot;));//打开sessionSessionsession=driver.session();//执行语句Stringcql=&quot;create(n:Person{name:$name,title:$title})&quot;;Stringinsert_test_str=session.writeTransaction(newTransactionWork&lt;String&gt;(){@OverridepublicStringexecute(Transactiontx){Resultresult=tx.run(cql,parameters(&quot;name&quot;,&quot;diomchen&quot;,&quot;title&quot;,&quot;TheCodeHero&quot;));return&quot;CreateNodeOK!&quot;;}});//关闭sessionsession.close();//关闭driverdriver.close();2.2springboot自动配置#yml基本配置neo4j:uri:bolt://&lt;host&gt;:7687username:neo4jpassword:123456通过cypher语句实现操作neo4j对象：@Data@Node(labels={&quot;Addresstxs&quot;})publicclassNAddresstxs{////自动生成id//@Id@GeneratedValue//privateLongid;//交易地址表Id@IdprivateStringaddresstxsId;//交易地址@Property(name=&quot;address&quot;)privateStringaddress;repository：@RepositorypublicinterfaceAddresstxsRepositoryextendsNeo4jRepository&lt;NAddresstxs,String&gt;{@Query(&quot;create(n:Addresstxs{addresstxsId:$addresstxsId,address:$address,type:$type})returnn&quot;)List&lt;NAddresstxs&gt;addAddresstxs(@Param(&quot;addresstxsId&quot;)StringaddresstxsId,@Param(&quot;address&quot;)Stringaddress,@Param(&quot;type&quot;)Integertype);@Query(&quot;match(n)returnn&quot;)List&lt;NAddresstxs&gt;getAddresstxs();/*特别需要注意返回的类型，否则会报以下问题*/}org.springframework.data.mapping.MappingException:TheschemaalreadycontainsanodedescriptionundertheprimarylabelAddresstxscypher语句在3.x和4.x中有所不同//java中cql(3.x)Stringcql=&quot;create(n:Person{name:{name},title:{title}})&quot;;//java中cql(4.x)Stringcql=&quot;create(n:Person{name:$name,title:$title})&quot;;通过Neo4jTemplatepom:&lt;dependency&gt;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&lt;artifactId&gt;spring-boot-starter-data-neo4j&lt;/artifactId&gt;&lt;/dependency&gt;注入:@ResourceNeo4jTemplateneo4jTemplate;其实和MongoTemplate操作一样，都是save，find等等，当然也支持自定条件。3.💾数据导入Neo4j数据库方面导入数据到neo4j是最影响使用体验的。3.1导入方式比较基本方式可以见下图，但是现在可用的只有create语句，loadcsv语句，apoc插件，其他的基本因为缺少维护而废用。第一种create语句，可以说是非常之慢，实际使用远低于下图的1000/s速度。第二种loadcsv语句，也是现在用的，3k+节点和12k+关系导入花了30分钟左右。但是网上有创建约束的方法解决，也有通过添加**:autousingperiodiccommit200**控制提交频率的方式来提高导入速度，这些都还未尝试过。最后一种apoc插件导入，还未使用，暂不做评价。3.2CSV数据创建和导入📃CSV规范Relationships规范START_IDEND_IDTYPE所以对于Node就需要有能够建立关系的标识性属性。cypher语句实际使用中，对于TYPE属性也并非硬性要求。⛓CSV创建与导出java先从mongo中读取所需数据创建导出csv所需属性的对象利用fastjson插件，将对象列表转成json字符串利用jackson插件，将json字符串转成csv导出csv文件工具类：//对象列表转csvpublicstatic&lt;T&gt;voidObject2Csv(List&lt;T&gt;objectList,StringsavePath)throwsIOException{JSONArrayjsonArray=newJSONArray();jsonArray.addAll(objectList);Stringss=jsonArray.toJSONString();JsonNodejsonNode=newObjectMapper().readTree(ss);CsvSchema.BuildercsvSchemaBuild=CsvSchema.builder();JsonNodefObject=jsonNode.elements().next();fObject.fieldNames().forEachRemaining(fieldName-&gt;{csvSchemaBuild.addColumn(fieldName);});CsvSchemacsvSchema=csvSchemaBuild.build().withHeader();OutputStreamWriterow=newOutputStreamWriter(newFileOutputStream(newFile(savePath)),&quot;gbk&quot;);CsvMappercsvMapper=newCsvMapper();csvMapper.writerFor(JsonNode.class).with(csvSchema).writeValue(ow,jsonNode);}//对象列表转jsonpublicstatic&lt;T&gt;voidObject2Json(List&lt;T&gt;objectList,StringsavePath)throwsIOException{JSONArrayjsonArray=newJSONArray();jsonArray.addAll(objectList);Stringss=jsonArray.toJSONString();save(ss,savePath);}privatestaticvoidsave(Stringjsonstr,Stringfilename)throwsIOException{OutputStreamWriterosw=newOutputStreamWriter(newFileOutputStream(filename),&quot;gbk&quot;);osw.write(jsonstr);osw.flush();osw.close();}🧣CSV导入只尝试过采用LOADCSV语句的导出方式。@Query(&quot;loadcsvwithHEADERSfrom\\&quot;file:///addrN.csv\\&quot;aslinemerge(n:Address{address:line.address})&quot;)voidoptInAddAddressNode();merge的好处，它会判断库里面是否以及存在该相同节点，若有，则不会创建，反之，则会创建新节点。这样就避免了库里面存在多个重复节点。参考资料：centos7服务器安装neo4j并实现远程访问Neo4jAdminimportapoc文档","link":"https://Diomchen.github.io/post/neo4j-wen-dang-zheng-li/"},{"title":"Hello Gridea","content":"👏欢迎使用Gridea！✍️Gridea一个静态博客写作客户端。你可以用它来记录你的生活、心情、知识、笔记、创意......GithubGridea主页示例网站特性👇📝你可以使用最酷的Markdown语法，进行快速创作🌉你可以给文章配上精美的封面图和在文章任意位置插入图片🏷️你可以对文章进行标签分组📋你可以自定义菜单，甚至可以创建外部链接菜单💻你可以在Windows，MacOS或Linux设备上使用此客户端🌎你可以使用𝖦𝗂𝗍𝗁𝗎𝖻𝖯𝖺𝗀𝖾𝗌或CodingPages向世界展示，未来将支持更多平台💬你可以进行简单的配置，接入Gitalk或DisqusJS评论系统🇬🇧你可以使用中文简体或英语🌁你可以任意使用应用内默认主题或任意第三方主题，强大的主题自定义能力🖥你可以自定义源文件夹，利用OneDrive、百度网盘、iCloud、Dropbox等进行多设备同步🌱当然Gridea还很年轻，有很多不足，但请相信，它会不停向前🏃未来，它一定会成为你离不开的伙伴尽情发挥你的才华吧！😘Enjoy~","link":"https://Diomchen.github.io/post/hello-gridea/"}]}